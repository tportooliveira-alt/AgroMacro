<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AgroMacro</title>
    <link rel="stylesheet" href="styles.css?v=20260211q">
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>
    <meta name="theme-color" content="#0F1318">
</head>

<body>

    <!-- Header -->
    <header class="app-header">
        <div class="logo-container">
            <svg class="logo-svg" width="32" height="32" viewBox="0 0 100 100">
                <path
                    d="M15 75 Q15 45 35 35 Q45 30 55 35 Q65 40 68 50 L85 45 Q88 42 90 45 L88 50 Q85 52 82 50 L70 54 Q72 62 68 70 L72 85 L65 85 L62 72 Q55 78 45 78 Q38 78 32 72 L30 85 L23 85 L27 70 Q22 62 22 55"
                    fill="#D4A843" />
                <circle cx="40" cy="42" r="3" fill="#0F1318" />
            </svg>
            <h1>AgroMacro</h1>
        </div>
        <button id="menu-btn" class="icon-btn" onclick="window.app.navigate('config')"><span data-icon="config"
                style="width:20px;height:20px;display:inline-flex;"></span></button>
    </header>

    <main id="app-container">

        <!-- ===================== HOME ===================== -->
        <section id="view-home" class="view active">

            <!-- Hero Greeting -->
            <div class="hero-greeting">
                <div class="greeting-text" id="greeting-text">Boa tarde</div>
                <div class="greeting-sub" id="greeting-date"></div>
            </div>

            <!-- KPI Dashboard ‚Äî Operational only, no financial values -->
            <div class="kpi-section">
                <div class="kpi-title">Painel da Fazenda</div>
                <div class="kpi-grid" id="kpi-grid"></div>
            </div>

            <!-- Quick Actions ‚Äî Atalhos R√°pidos -->
            <div class="kpi-title" style="margin-top:4px;">A√ß√µes R√°pidas</div>
            <div class="home-grid">
                <button class="home-card" onclick="window.app.navigate('compra')">
                    <div class="home-card-icon" data-icon="compraRapida"
                        style="background: linear-gradient(135deg, #0F766E, #115E59);"></div>
                    <span class="home-card-title">Compra</span>
                    <span class="home-card-sub">Registrar compra</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('venda')">
                    <div class="home-card-icon" data-icon="vendaRapida"
                        style="background: linear-gradient(135deg, #14532D, #166534);"></div>
                    <span class="home-card-title">Venda</span>
                    <span class="home-card-sub">Registrar venda</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('manejo')">
                    <div class="home-card-icon" data-icon="manejoRapido"
                        style="background: linear-gradient(135deg, #1E3A5F, #1E40AF);"></div>
                    <span class="home-card-title">Manejo</span>
                    <span class="home-card-sub">R√°pido</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('estoque')">
                    <div class="home-card-icon" data-icon="abastecer"
                        style="background: linear-gradient(135deg, #78350F, #92400E);"></div>
                    <span class="home-card-title">Abastecer</span>
                    <span class="home-card-sub">Estoque</span>
                </button>
            </div>

            <!-- Cota√ß√£o do Rebanho em P√© -->
            <div id="cotacao-rebanho" style="margin-top:16px;"></div>

            <!-- Dashboard Gr√°ficos -->
            <div id="graficos-home" style="margin-top:16px;"></div>

            <!-- Alerts Section -->
            <div class="alerts-section">
                <div class="alerts-title">Alertas</div>
                <div id="alerts-list"></div>
            </div>

        </section>

        <!-- ===================== FINANCEIRO HUB ===================== -->
        <section id="view-financeiro" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('financeiro-hub')">‚Üê</button>
                <h2>Financeiro</h2>
            </div>

            <div class="home-grid">
                <button class="home-card" onclick="window.app.navigate('compra')">
                    <div class="home-card-icon" data-icon="compra"
                        style="background: linear-gradient(135deg, #0F766E, #115E59);"></div>
                    <span class="home-card-title">Compra de Gado</span>
                    <span class="home-card-sub">Registrar entrada</span>
                </button>

                <button class="home-card" onclick="window.app.navigate('venda')">
                    <div class="home-card-icon" data-icon="venda"
                        style="background: linear-gradient(135deg, #14532D, #166534);"></div>
                    <span class="home-card-title">Venda de Gado</span>
                    <span class="home-card-sub">Registrar sa√≠da</span>
                </button>

                <button class="home-card" onclick="window.app.navigate('fluxo')">
                    <div class="home-card-icon" data-icon="fluxo"
                        style="background: linear-gradient(135deg, #1E3A5F, #1E40AF);"></div>
                    <span class="home-card-title">Fluxo de Caixa</span>
                    <span class="home-card-sub">Entradas e sa√≠das</span>
                </button>

                <button class="home-card" onclick="window.app.navigate('balanco')">
                    <div class="home-card-icon" data-icon="balanco"
                        style="background: linear-gradient(135deg, #155E75, #164E63);"></div>
                    <span class="home-card-title">Balan√ßo / DRE</span>
                    <span class="home-card-sub">Resultado operacional</span>
                </button>
            </div>

            <!-- Quick links -->
            <div class="tertiary-actions" style="margin-top: 8px;">
                <button class="action-btn" onclick="window.app.navigate('obras')">Obras</button>
                <button class="action-btn" onclick="window.app.navigate('funcionarios')">Funcion√°rios</button>
            </div>
        </section>

        <!-- ===================== COMPRA DE GADO ===================== -->
        <section id="view-compra" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('financeiro-hub')">‚Üê</button>
                <h2>Compra de Gado</h2>
            </div>
            <form id="form-compra" class="card-form">
                <div class="form-group">
                    <label>Quantidade de Animais</label>
                    <input type="number" id="compra-qty" placeholder="30" required>
                </div>
                <div class="form-group">
                    <label>Peso M√©dio (kg)</label>
                    <input type="number" id="compra-peso" step="0.1" placeholder="220">
                </div>
                <div class="form-group">
                    <label>Valor Total Pago (R$)</label>
                    <input type="number" id="compra-valor" step="0.01" placeholder="120000.00" required>
                </div>
                <div class="form-group">
                    <label>Descri√ß√£o</label>
                    <input type="text" id="compra-desc" placeholder="Ex: 30 Bezerros Nelore">
                </div>
                <div class="form-group">
                    <label>Fornecedor</label>
                    <input type="text" id="compra-fornecedor" placeholder="Ex: Fazenda S√£o Jo√£o">
                </div>
                <div class="form-group">
                    <label>Lote de Destino</label>
                    <select id="compra-lote">
                        <option value="">Selecionar Lote...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Data</label>
                    <input type="date" id="compra-data" required>
                </div>
                <button type="submit" class="submit-btn">Registrar Compra</button>
            </form>
        </section>

        <!-- ===================== VENDA DE GADO ===================== -->
        <section id="view-venda" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('financeiro-hub')">‚Üê</button>
                <h2>Venda de Gado</h2>
            </div>
            <form id="form-venda" class="card-form">
                <div class="form-group">
                    <label>Lote</label>
                    <select id="venda-lote">
                        <option value="">Selecionar Lote...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Quantidade de Animais</label>
                    <input type="number" id="venda-qty" placeholder="5" required>
                </div>
                <div class="form-group">
                    <label>Peso M√©dio (kg)</label>
                    <input type="number" id="venda-peso" step="0.1" placeholder="480">
                </div>
                <div class="form-group">
                    <label>Valor Total (R$)</label>
                    <input type="number" id="venda-valor" step="0.01" placeholder="25000.00" required>
                </div>
                <div class="form-group">
                    <label>Comprador</label>
                    <input type="text" id="venda-comprador" placeholder="Ex: Frigor√≠fico XYZ">
                </div>
                <div class="form-group">
                    <label>Descri√ß√£o</label>
                    <input type="text" id="venda-desc" placeholder="Ex: Venda 5 Bois Gordos">
                </div>
                <div class="form-group">
                    <label>Data</label>
                    <input type="date" id="venda-data" required>
                </div>
                <button type="submit" class="submit-btn">Registrar Venda</button>
            </form>
        </section>

        <!-- ===================== REBANHO ===================== -->
        <section id="view-rebanho" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('rebanho-hub')">‚Üê</button>
                <h2>Cadastro de Rebanho</h2>
            </div>
            <!-- Tabs -->
            <div class="tab-bar">
                <button class="tab-btn active"
                    onclick="window.rebanho.switchTab('individual', this)">Individual</button>
                <button class="tab-btn" onclick="window.rebanho.switchTab('lote', this)">Por Lote</button>
            </div>

            <!-- Tab: Individual -->
            <form id="form-rebanho" class="card-form tab-content active" data-tab="individual">
                <div class="form-row">
                    <div class="form-group">
                        <label>Brinco / ID</label>
                        <input type="text" id="reb-brinco" placeholder="Ex: B-001" required>
                    </div>
                    <div class="form-group">
                        <label>Ra√ßa</label>
                        <select id="reb-raca">
                            <option value="Nelore">Nelore</option>
                            <option value="Angus">Angus</option>
                            <option value="Brahman">Brahman</option>
                            <option value="Gir">Gir</option>
                            <option value="Girolando">Girolando</option>
                            <option value="Tabapu√£">Tabapu√£</option>
                            <option value="Senepol">Senepol</option>
                            <option value="Mesti√ßo">Mesti√ßo</option>
                            <option value="Outra">Outra</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Sexo</label>
                        <select id="reb-sexo">
                            <option value="macho">‚ôÇ Macho</option>
                            <option value="femea">‚ôÄ F√™mea</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Peso Atual (kg)</label>
                        <input type="number" id="reb-peso" step="0.1" placeholder="220">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Data Nascimento</label>
                        <input type="date" id="reb-nascimento">
                    </div>
                    <div class="form-group">
                        <label>Origem</label>
                        <select id="reb-origem">
                            <option value="compra">Compra</option>
                            <option value="nascimento">Nascimento</option>
                            <option value="doacao">Doa√ß√£o</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Lote</label>
                    <select id="reb-lote">
                        <option value="">Sem Lote</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Observa√ß√µes</label>
                    <input type="text" id="reb-obs" placeholder="Opcional">
                </div>
                <button type="submit" class="submit-btn">Cadastrar Animal</button>
            </form>

            <!-- Tab: Por Lote (cadastro em grupo) -->
            <form id="form-rebanho-lote" class="card-form tab-content" data-tab="lote" style="display:none;">
                <div class="form-group">
                    <label>Nome / Identifica√ß√£o do Lote</label>
                    <input type="text" id="reb-lote-nome" placeholder="Ex: Lote Compra Jan/2026" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Quantidade de Animais</label>
                        <input type="number" id="reb-lote-qtd" placeholder="30" required>
                    </div>
                    <div class="form-group">
                        <label>Ra√ßa Predominante</label>
                        <select id="reb-lote-raca">
                            <option value="Nelore">Nelore</option>
                            <option value="Angus">Angus</option>
                            <option value="Brahman">Brahman</option>
                            <option value="Gir">Gir</option>
                            <option value="Girolando">Girolando</option>
                            <option value="Tabapu√£">Tabapu√£</option>
                            <option value="Senepol">Senepol</option>
                            <option value="Mesti√ßo">Mesti√ßo</option>
                            <option value="Outra">Outra</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Peso M√©dio (kg)</label>
                        <input type="number" id="reb-lote-peso" step="0.1" placeholder="220">
                    </div>
                    <div class="form-group">
                        <label>Idade M√©dia (meses)</label>
                        <input type="number" id="reb-lote-idade" placeholder="18">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Sexo Predominante</label>
                        <select id="reb-lote-sexo">
                            <option value="macho">‚ôÇ Machos</option>
                            <option value="femea">‚ôÄ F√™meas</option>
                            <option value="misto">‚ö§ Misto</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Origem</label>
                        <select id="reb-lote-origem">
                            <option value="compra">Compra</option>
                            <option value="nascimento">Nascimento</option>
                            <option value="doacao">Doa√ß√£o</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Lote Destino</label>
                    <select id="reb-lote-destino">
                        <option value="">Sem Lote</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Observa√ß√µes</label>
                    <input type="text" id="reb-lote-obs" placeholder="Opcional">
                </div>
                <button type="submit" class="submit-btn">Cadastrar Lote de Animais</button>
            </form>

            <div class="section-title" style="margin-top:24px;">Rebanho Atual</div>
            <div id="rebanho-list"></div>
        </section>

        <!-- ===================== LOTES ===================== -->
        <section id="view-lotes" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('rebanho-hub')">‚Üê</button>
                <h2>Gest√£o de Lotes</h2>
            </div>
            <form id="form-lote" class="card-form">
                <div class="form-group">
                    <label>Nome do Lote</label>
                    <input type="text" id="lote-nome" placeholder="Ex: Lote S√£o Jo√£o" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Categoria</label>
                        <select id="lote-categoria">
                            <option value="cria">üêÆ Cria</option>
                            <option value="recria">üêÇ Recria</option>
                            <option value="engorda">ü•© Engorda</option>
                            <option value="matrizes">üêÑ Matrizes</option>
                            <option value="touros">üêÉ Touros</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Qtd Animais</label>
                        <input type="number" id="lote-qtd" placeholder="30" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Ra√ßa Predominante</label>
                    <select id="lote-raca">
                        <option value="">Selecionar...</option>
                        <option value="Nelore">Nelore</option>
                        <option value="Angus">Angus</option>
                        <option value="Nelore x Angus">Nelore x Angus</option>
                        <option value="Brahman">Brahman</option>
                        <option value="Gir">Gir</option>
                        <option value="Girolando">Girolando</option>
                        <option value="Tabapu√£">Tabapu√£</option>
                        <option value="Senepol">Senepol</option>
                        <option value="Nelore PO">Nelore PO</option>
                        <option value="Mesti√ßo">Mesti√ßo</option>
                        <option value="Outra">Outra</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Peso M√©dio (kg)</label>
                        <input type="number" id="lote-peso-medio" step="0.1" placeholder="220">
                    </div>
                    <div class="form-group">
                        <label>Pasto Atual</label>
                        <select id="lote-pasto">
                            <option value="">Selecionar...</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Data de Entrada</label>
                    <input type="date" id="lote-data-entrada">
                </div>
                <div class="section-title" style="margin-top:12px;">Nutri√ß√£o do Lote</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Sal Mineral</label>
                        <select id="lote-sal">
                            <option value="">Nenhum</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Consumo Sal (g/cab/dia)</label>
                        <input type="number" id="lote-sal-consumo" step="0.1" placeholder="80">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ra√ß√£o</label>
                        <select id="lote-racao">
                            <option value="">Nenhuma</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Consumo Ra√ß√£o (kg/cab/dia)</label>
                        <input type="number" id="lote-racao-consumo" step="0.1" placeholder="2.5">
                    </div>
                </div>
                <div class="form-group">
                    <label>Observa√ß√µes</label>
                    <input type="text" id="lote-obs" placeholder="Opcional">
                </div>
                <button type="submit" class="submit-btn">Cadastrar Lote</button>
            </form>
            <div class="section-title" style="margin-top:24px;">Lotes Ativos</div>
            <div id="lotes-list"></div>
            <div id="indicadores-produtivos" style="margin-top:16px;"></div>
            <div style="display:flex; gap:8px; margin-top:16px;">
                <button type="button" class="submit-btn" style="flex:1;"
                    onclick="window.relatorio.relatorioLotes('pdf')">üìÑ Salvar PDF</button>
                <button type="button" class="submit-btn"
                    style="flex:1; background:linear-gradient(135deg,#1E3A5F,#1E40AF);"
                    onclick="window.relatorio.relatorioLotes('print')">üñ®Ô∏è Imprimir</button>
            </div>
        </section>

        <!-- ===================== PASTOS ===================== -->
        <section id="view-pastos" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('rebanho-hub')">‚Üê</button>
                <h2>Cadastro de Pastos</h2>
            </div>
            <form id="form-pasto" class="card-form">
                <div class="form-group">
                    <label>Nome do Pasto / Piquete</label>
                    <input type="text" id="pasto-nome" placeholder="Ex: Piquete Norte" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>√Årea (hectares)</label>
                        <input type="number" id="pasto-area" step="0.1" placeholder="15.0">
                    </div>
                    <div class="form-group">
                        <label>Capacidade (cabe√ßas)</label>
                        <input type="number" id="pasto-capacidade" placeholder="50">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Tipo de Capim</label>
                        <select id="pasto-tipo">
                            <option value="Braqui√°ria">Braqui√°ria</option>
                            <option value="Momba√ßa">Momba√ßa</option>
                            <option value="Tifton">Tifton</option>
                            <option value="Marandu">Marandu</option>
                            <option value="Tanz√¢nia">Tanz√¢nia</option>
                            <option value="Outro">Outro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="pasto-status">
                            <option value="disponivel">üü¢ Dispon√≠vel</option>
                            <option value="ocupado">üî¥ Ocupado</option>
                            <option value="descanso">üü° Em Descanso</option>
                            <option value="manutencao">üîß Manuten√ß√£o</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Observa√ß√µes</label>
                    <input type="text" id="pasto-obs" placeholder="Opcional">
                </div>
                <button type="submit" class="submit-btn">Cadastrar Pasto</button>
            </form>
            <div class="section-title" style="margin-top:24px;">Pastos Cadastrados</div>
            <div id="pastos-list"></div>
            <div style="display:flex; gap:8px; margin-top:16px;">
                <button type="button" class="submit-btn" style="flex:1;"
                    onclick="window.relatorio.relatorioPastos('pdf')">üìÑ Salvar PDF</button>
                <button type="button" class="submit-btn"
                    style="flex:1; background:linear-gradient(135deg,#1E3A5F,#1E40AF);"
                    onclick="window.relatorio.relatorioPastos('print')">üñ®Ô∏è Imprimir</button>
            </div>
        </section>

        <!-- ===================== ESTOQUE ===================== -->
        <section id="view-estoque" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('operacoes-hub')">‚Üê</button>
                <h2>Estoque de Insumos</h2>
            </div>
            <!-- Quick add form -->
            <form id="form-estoque" class="card-form" style="margin-bottom:16px;">
                <div class="form-group">
                    <label>Categoria</label>
                    <select id="est-categoria" onchange="window.estoque.onCategoryChange()">
                        <option value="racao_sal">üßÇ Ra√ß√£o / Sal Mineral</option>
                        <option value="remedios">üíä Rem√©dios / Vacinas</option>
                        <option value="obras">üî® Obras / Ferramentas</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Produto</label>
                    <select id="est-produto-sugestao" onchange="window.estoque.onSuggestionSelect()">
                        <option value="">‚Äî Selecionar ou digitar abaixo ‚Äî</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Nome do Produto</label>
                    <input type="text" id="est-produto" placeholder="Ex: Sal Mineral Fosbovi" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Qtd de Sacos</label>
                        <input type="number" id="est-qty" placeholder="10" required
                            oninput="window.estoque.calcTotal()">
                    </div>
                    <div class="form-group">
                        <label>Peso por Saco (kg)</label>
                        <input type="number" id="est-peso-saco" step="0.1" placeholder="25" value="25"
                            oninput="window.estoque.calcTotal()">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Valor por Saco (R$)</label>
                        <input type="number" id="est-valor" step="0.01" placeholder="85.00"
                            oninput="window.estoque.calcTotal()">
                    </div>
                    <div class="form-group">
                        <label>Categoria</label>
                        <input type="text" id="est-unit" placeholder="sacos" value="sacos">
                    </div>
                </div>
                <div id="est-total-preview" class="calc-preview" style="display:none;">
                </div>
                <button type="submit" class="submit-btn">Registrar Entrada</button>
            </form>
            <!-- Filter -->
            <div class="filter-bar" style="display:flex; gap:8px; margin-bottom:12px; flex-wrap:wrap;">
                <button type="button" class="filter-btn active"
                    onclick="window.estoque.filterBy('todos')">Todos</button>
                <button type="button" class="filter-btn"
                    onclick="window.estoque.filterBy('racao_sal')">Ra√ß√£o/Sal</button>
                <button type="button" class="filter-btn" onclick="window.estoque.filterBy('remedios')">Rem√©dios</button>
                <button type="button" class="filter-btn" onclick="window.estoque.filterBy('obras')">Obras</button>
            </div>
            <div id="estoque-list"></div>
            <div style="display:flex; gap:8px; margin-top:16px;">
                <button type="button" class="submit-btn" style="flex:1;"
                    onclick="window.relatorio.relatorioEstoque('pdf')">üìÑ Salvar PDF</button>
                <button type="button" class="submit-btn"
                    style="flex:1; background:linear-gradient(135deg,#1E3A5F,#1E40AF);"
                    onclick="window.relatorio.relatorioEstoque('print')">üñ®Ô∏è Imprimir</button>
            </div>
        </section>

        <!-- ===================== FLUXO DE CAIXA ===================== -->
        <section id="view-fluxo" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('financeiro-hub')">‚Üê</button>
                <h2>Fluxo de Caixa</h2>
            </div>
            <div id="fluxo-content"></div>
            <div id="indicadores-financeiros"></div>
            <div style="display:flex; gap:8px; margin-top:16px;">
                <button type="button" class="submit-btn" style="flex:1;"
                    onclick="window.relatorio.relatorioFluxo('pdf')">üìÑ Salvar PDF</button>
                <button type="button" class="submit-btn"
                    style="flex:1; background:linear-gradient(135deg,#1E3A5F,#1E40AF);"
                    onclick="window.relatorio.relatorioFluxo('print')">üñ®Ô∏è Imprimir</button>
            </div>
        </section>

        <!-- ===================== MANEJO ===================== -->
        <section id="view-manejo" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('rebanho-hub')">‚Üê</button>
                <h2>Manejo</h2>
            </div>
            <form id="form-manejo" class="card-form">
                <div class="form-group">
                    <label>Tipo de Manejo</label>
                    <select id="manejo-tipo">
                        <option value="vacinacao">ü©∫ Vacina√ß√£o / Sanit√°rio</option>
                        <option value="pesagem">‚öñÔ∏è Pesagem</option>
                        <option value="movimentacao">üîÑ Movimenta√ß√£o de Pasto</option>
                        <option value="mortalidade">‚ö†Ô∏è Mortalidade</option>
                        <option value="outro">üìù Outro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Lote</label>
                    <select id="manejo-lote">
                        <option value="">Selecionar Lote...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Produto / Descri√ß√£o</label>
                    <select id="manejo-produto"
                        onchange="if(this.value==='__outro__'){document.getElementById('manejo-desc-custom').style.display='block'}else{document.getElementById('manejo-desc-custom').style.display='none'}">
                        <option value="">Selecionar do Estoque...</option>
                    </select>
                    <input type="text" id="manejo-desc-custom" placeholder="Descreva o manejo..."
                        style="display:none; margin-top:8px;">
                    <input type="hidden" id="manejo-desc" value="">
                </div>
                <div class="form-group">
                    <label>Quantidade de Animais</label>
                    <input type="number" id="manejo-qtd" placeholder="0">
                </div>
                <div class="form-group">
                    <label>Data</label>
                    <input type="date" id="manejo-data" required>
                </div>
                <div class="section-title">Materiais Utilizados (do Estoque)</div>
                <div id="manejo-materials-list" class="materials-list"></div>
                <div class="form-group">
                    <label>Custo Estimado (R$)</label>
                    <input type="number" id="manejo-custo" step="0.01" placeholder="0,00">
                </div>
                <button type="submit" class="submit-btn">Registrar Manejo</button>
            </form>
            <div class="section-title" style="margin-top:24px;">Hist√≥rico de Manejos</div>
            <div id="manejo-history"></div>
            <div style="display:flex; gap:8px; margin-top:16px;">
                <button type="button" class="submit-btn" style="flex:1;"
                    onclick="window.relatorio.relatorioManejo('pdf')">üìÑ Salvar PDF</button>
                <button type="button" class="submit-btn"
                    style="flex:1; background:linear-gradient(135deg,#1E3A5F,#1E40AF);"
                    onclick="window.relatorio.relatorioManejo('print')">üñ®Ô∏è Imprimir</button>
            </div>
        </section>

        <!-- ===================== OBRAS ===================== -->
        <section id="view-rastreabilidade" class="view hidden">
            <header class="top-header">
                <button class="nav-icon" onclick="window.app.toggleMenu()">
                    <svg viewBox="0 0 24 24" fill="none" class="icon-svg">
                        <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round">
                        </path>
                    </svg>
                </button>
                <h1>Rastreabilidade SISBOV</h1>
                <button class="nav-icon" onclick="window.app.showSection('view-operacoes-hub')">
                    <svg viewBox="0 0 24 24" fill="none" class="icon-svg">
                        <path d="M19 12H5m0 0l7 7m-7-7l7-7" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                </button>
            </header>
            <main class="page-content" id="rastreabilidade-content">
                <!-- Rendered by JS -->
            </main>
        </section>

        <section id="view-obras" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('operacoes-hub')">‚Üê</button>
                <h2>Registrar Obra</h2>
            </div>
            <form id="form-obra" class="card-form">
                <div class="form-group">
                    <label>Nome da Obra</label>
                    <input type="text" id="obra-nome" placeholder="Ex: Cercamento Curral 2" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Data de In√≠cio</label>
                        <input type="date" id="obra-inicio" required>
                    </div>
                    <div class="form-group">
                        <label>Data de T√©rmino</label>
                        <input type="date" id="obra-fim">
                    </div>
                </div>
                <div class="form-group">
                    <label>Observa√ß√µes</label>
                    <textarea id="obra-obs" rows="2"></textarea>
                </div>
                <div class="section-title">Funcion√°rios na Obra</div>
                <div id="workers-list" class="workers-grid"></div>
                <button type="button" class="add-btn" onclick="window.obras.addWorker()">+ Adicionar
                    Funcion√°rio</button>
                <div class="section-title">Materiais Utilizados (do Estoque)</div>
                <div id="obra-materials-list" class="materials-list"></div>
                <button type="submit" class="submit-btn">Registrar Obra</button>
            </form>
        </section>

        <!-- ===================== FUNCION√ÅRIOS ===================== -->
        <section id="view-funcionarios" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('operacoes-hub')">‚Üê</button>
                <h2>Funcion√°rios</h2>
            </div>
            <form id="form-funcionario" class="card-form">
                <div class="form-group">
                    <label>Nome Completo</label>
                    <input type="text" id="func-nome" placeholder="Ex: Jo√£o da Silva" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Fun√ß√£o</label>
                        <select id="func-funcao">
                            <option value="Pe√£o">ü§† Pe√£o</option>
                            <option value="Tratorista">üöú Tratorista</option>
                            <option value="Cercador">üîß Cercador</option>
                            <option value="Vaqueiro">üêÑ Vaqueiro</option>
                            <option value="Capataz">üëî Capataz</option>
                            <option value="Servicos Gerais">üßπ Servi√ßos Gerais</option>
                            <option value="Diarista">üìã Diarista</option>
                            <option value="Outro">üìù Outro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Di√°ria (R$)</label>
                        <input type="number" id="func-diaria" step="0.01" placeholder="150.00">
                    </div>
                </div>
                <div class="form-group">
                    <label>Telefone</label>
                    <input type="tel" id="func-telefone" placeholder="(xx) xxxxx-xxxx">
                </div>
                <button type="submit" class="submit-btn">‚úÖ Cadastrar Funcion√°rio</button>
            </form>
            <div class="section-title" style="margin-top:24px;">Funcion√°rios Cadastrados</div>
            <div id="funcionarios-list"></div>
            <div style="display:flex; gap:8px; margin-top:16px;">
                <button type="button" class="submit-btn" style="flex:1;"
                    onclick="window.relatorio.relatorioFuncionarios('pdf')">üìÑ Salvar PDF</button>
                <button type="button" class="submit-btn"
                    style="flex:1; background:linear-gradient(135deg,#1E3A5F,#1E40AF);"
                    onclick="window.relatorio.relatorioFuncionarios('print')">üñ®Ô∏è Imprimir</button>
            </div>
        </section>

        <!-- ===================== BALAN√áO / DRE ===================== -->
        <section id="view-balanco" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('financeiro-hub')">‚Üê</button>
                <h2>Balan√ßo & DRE</h2>
            </div>
            <div id="balanco-content"></div>
            <div style="display:flex; gap:8px; margin-top:16px;">
                <button type="button" class="submit-btn" style="flex:1;"
                    onclick="window.relatorio.gerarRelatorio('pdf')">üìÑ Salvar PDF</button>
                <button type="button" class="submit-btn"
                    style="flex:1; background:linear-gradient(135deg,#1E3A5F,#1E40AF);"
                    onclick="window.relatorio.gerarRelatorio('print')">üñ®Ô∏è Imprimir</button>
            </div>
        </section>

        <!-- ===================== CONFIGURA√á√ïES ===================== -->
        <section id="view-config" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('home')">‚Üê</button>
                <h2>Configura√ß√µes</h2>
            </div>

            <div class="card-form">
                <div class="section-title">Fazenda</div>
                <div class="form-group">
                    <label>Nome da Fazenda</label>
                    <input type="text" id="config-nome-fazenda" placeholder="Ex: Fazenda S√£o Jo√£o"
                        onchange="window.app.saveConfig()">
                </div>
                <div class="form-group">
                    <label>Propriet√°rio</label>
                    <input type="text" id="config-proprietario" placeholder="Nome completo"
                        onchange="window.app.saveConfig()">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Cidade</label>
                        <input type="text" id="config-cidade" placeholder="Cidade" onchange="window.app.saveConfig()">
                    </div>
                    <div class="form-group">
                        <label>Estado</label>
                        <select id="config-estado" onchange="window.app.saveConfig()">
                            <option value="">Selecione</option>
                            <option value="AC">AC</option>
                            <option value="AL">AL</option>
                            <option value="AM">AM</option>
                            <option value="AP">AP</option>
                            <option value="BA">BA</option>
                            <option value="CE">CE</option>
                            <option value="DF">DF</option>
                            <option value="ES">ES</option>
                            <option value="GO">GO</option>
                            <option value="MA">MA</option>
                            <option value="MG">MG</option>
                            <option value="MS">MS</option>
                            <option value="MT">MT</option>
                            <option value="PA">PA</option>
                            <option value="PB">PB</option>
                            <option value="PE">PE</option>
                            <option value="PI">PI</option>
                            <option value="PR">PR</option>
                            <option value="RJ">RJ</option>
                            <option value="RN">RN</option>
                            <option value="RO">RO</option>
                            <option value="RR">RR</option>
                            <option value="RS">RS</option>
                            <option value="SC">SC</option>
                            <option value="SE">SE</option>
                            <option value="SP">SP</option>
                            <option value="TO">TO</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>√Årea Total (hectares)</label>
                    <input type="number" id="config-area" step="0.1" placeholder="0" onchange="window.app.saveConfig()">
                </div>
            </div>

            <div class="card-form" style="margin-top:16px;">
                <div class="section-title">Dados</div>
                <button type="button" class="submit-btn" style="margin-bottom:10px;"
                    onclick="window.app.exportData()">Exportar Dados (JSON)</button>
                <button type="button" class="submit-btn danger-btn" onclick="window.app.resetData()">Zerar Todos os
                    Dados</button>
                <p class="info-note" style="margin-top:15px;">Esta a√ß√£o apaga todos os registros. N√£o pode ser desfeita.
                </p>
            </div>

            <div class="card-form" style="margin-top:16px;">
                <div class="section-title">Sobre</div>
                <p style="font-size:12px; color:var(--text-2); line-height:1.6;">
                    <strong>AgroMacro</strong> v2.0<br>
                    Sistema de Gest√£o Pecu√°ria<br>
                    Dados salvos localmente no dispositivo
                </p>
            </div>
        </section>

        <!-- ===================== CALEND√ÅRIO SANIT√ÅRIO ===================== -->
        <section id="view-calendario" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('rebanho-hub')">‚Üê</button>
                <h2>Calend√°rio Sanit√°rio</h2>
            </div>
            <div id="calendario-content"></div>
            <div style="display:flex; gap:8px; margin-top:16px;">
                <button type="button" class="submit-btn" style="flex:1;"
                    onclick="window.relatorio.relatorioCalendario('pdf')">üìÑ Salvar PDF</button>
                <button type="button" class="submit-btn"
                    style="flex:1; background:linear-gradient(135deg,#1E3A5F,#1E40AF);"
                    onclick="window.relatorio.relatorioCalendario('print')">üñ®Ô∏è Imprimir</button>
            </div>
        </section>

        <!-- ===================== CONTAS A PAGAR ===================== -->
        <section id="view-contas" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('financeiro-hub')">‚Üê</button>
                <h2>Contas a Pagar</h2>
            </div>
            <div id="contas-pagar-content"></div>
            <div style="display:flex; gap:8px; margin-top:16px;">
                <button type="button" class="submit-btn" style="flex:1;"
                    onclick="window.relatorio.relatorioContas('pdf')">üìÑ Salvar PDF</button>
                <button type="button" class="submit-btn"
                    style="flex:1; background:linear-gradient(135deg,#1E3A5F,#1E40AF);"
                    onclick="window.relatorio.relatorioContas('print')">üñ®Ô∏è Imprimir</button>
            </div>
        </section>

        <!-- ===================== HUB: REBANHO ===================== -->
        <section id="view-rebanho-hub" class="view hidden">
            <div class="view-header">
                <h2>Rebanho</h2>
            </div>
            <div class="home-grid">
                <button class="home-card" onclick="window.app.navigate('lotes')">
                    <div class="home-card-icon" data-icon="lotes"
                        style="background: linear-gradient(135deg, #0F766E, #115E59);"></div>
                    <span class="home-card-title">Lotes</span>
                    <span class="home-card-sub">Gest√£o por lote</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('cabecas')">
                    <div class="home-card-icon" data-icon="cabecas"
                        style="background: linear-gradient(135deg, #155E75, #164E63);"></div>
                    <span class="home-card-title">Cabe√ßas</span>
                    <span class="home-card-sub">Individual</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('pastos')">
                    <div class="home-card-icon" data-icon="pastos"
                        style="background: linear-gradient(135deg, #14532D, #166534);"></div>
                    <span class="home-card-title">Pastos</span>
                    <span class="home-card-sub">Piquetes e rota√ß√£o</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('manejo')">
                    <div class="home-card-icon" data-icon="manejo"
                        style="background: linear-gradient(135deg, #1E3A5F, #1E40AF);"></div>
                    <span class="home-card-title">Manejo</span>
                    <span class="home-card-sub">Vacinas e pesagem</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('calendario')">
                    <div class="home-card-icon" data-icon="calendario"
                        style="background: linear-gradient(135deg, #7F1D1D, #991B1B);"></div>
                    <span class="home-card-title">Calend√°rio</span>
                    <span class="home-card-sub">Sanit√°rio</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('rebanho')">
                    <div class="home-card-icon" data-icon="indicadores"
                        style="background: linear-gradient(135deg, #1E3A5F, #0C4A6E);"></div>
                    <span class="home-card-title">Indicadores</span>
                    <span class="home-card-sub">Produtivos</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('genetica')">
                    <div class="home-card-icon"
                        style="background: linear-gradient(135deg, #7C3AED, #6D28D9);font-size:20px;display:flex;align-items:center;justify-content:center;">
                        üß¨</div>
                    <span class="home-card-title">Gen√©tica</span>
                    <span class="home-card-sub">Avaliar Touro</span>
                </button>
            </div>
        </section>

        <!-- ===================== GEN√âTICA ‚Äî Avalia√ß√£o de Touros ===================== -->
        <section id="view-genetica" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('rebanho-hub')">‚Üê</button>
                <h2>üß¨ Avalia√ß√£o Gen√©tica</h2>
            </div>

            <!-- Info -->
            <div class="card"
                style="padding:14px;margin-bottom:12px;background:linear-gradient(135deg,#7C3AED20,#6D28D920);border:1px solid #7C3AED40;">
                <div style="font-size:14px;line-height:1.5;">üìã Insira os <strong>DEPs</strong> do sum√°rio gen√©tico
                    (PMGZ, ANCP ou Embrapa) e receba uma an√°lise simples de aptid√£o para <strong>Cria</strong>,
                    <strong>Engorda</strong> e <strong>Reposi√ß√£o</strong>.
                </div>
            </div>

            <!-- Identifica√ß√£o -->
            <div class="card-form">
                <div class="section-title">üêÉ Identifica√ß√£o do Animal</div>
                <div class="form-group">
                    <label>Nome / Registro</label>
                    <input type="text" id="gen-nome" placeholder="Ex: TOURO SAMURAI CFM">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ra√ßa</label>
                        <select id="gen-raca">
                            <option value="Nelore">Nelore</option>
                            <option value="Nelore PO">Nelore PO</option>
                            <option value="Angus">Angus</option>
                            <option value="Brahman">Brahman</option>
                            <option value="Tabapu√£">Tabapu√£</option>
                            <option value="Senepol">Senepol</option>
                            <option value="Guzer√°">Guzer√°</option>
                            <option value="Outra">Outra</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Sexo</label>
                        <select id="gen-sexo">
                            <option value="macho">‚ôÇ Macho (Touro)</option>
                            <option value="femea">‚ôÄ F√™mea (Matriz)</option>
                        </select>
                    </div>
                </div>

                <!-- √çndices Bioecon√¥micos -->
                <div class="section-title" style="margin-top:16px;">üìä √çndices (se dispon√≠vel)</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>iABCZ</label>
                        <input type="number" id="gen-iabcz" step="0.1" placeholder="Ex: 12.5">
                    </div>
                    <div class="form-group">
                        <label>MGTe</label>
                        <input type="number" id="gen-mgte" step="0.1" placeholder="Ex: 8.7">
                    </div>
                </div>

                <!-- DEPs: Crescimento -->
                <div class="section-title" style="margin-top:16px;">üìè Crescimento</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Peso Nascer (PN)</label>
                        <input type="number" id="gen-pn" step="0.1" placeholder="Ex: -0.5">
                    </div>
                    <div class="form-group">
                        <label>Peso Desmama Direto (P120)</label>
                        <input type="number" id="gen-p120" step="0.1" placeholder="Ex: 8.2">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Peso Desmama (P210)</label>
                        <input type="number" id="gen-p210" step="0.1" placeholder="Ex: 14.2">
                    </div>
                    <div class="form-group">
                        <label>Peso Ano (P365)</label>
                        <input type="number" id="gen-p365" step="0.1" placeholder="Ex: 18.5">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Peso Sobreano (P450)</label>
                        <input type="number" id="gen-p450" step="0.1" placeholder="Ex: 22.8">
                    </div>
                    <div class="form-group">
                        <label>Ganho Peso (GPD) g/dia</label>
                        <input type="number" id="gen-gpd" step="0.1" placeholder="Ex: 55">
                    </div>
                </div>

                <!-- DEPs: Reprodu√ß√£o -->
                <div class="section-title" style="margin-top:16px;">üêÑ Reprodu√ß√£o e Maternidade</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Hab. Materna (MP210)</label>
                        <input type="number" id="gen-mp210" step="0.1" placeholder="Ex: 6.8">
                    </div>
                    <div class="form-group">
                        <label>Perim. Escrotal (PE)</label>
                        <input type="number" id="gen-pe" step="0.1" placeholder="Ex: 3.2">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Idade 1¬∫ Parto (IPP)</label>
                        <input type="number" id="gen-ipp" step="0.1" placeholder="Ex: -8.5">
                    </div>
                    <div class="form-group">
                        <label>Parto Precoce (3P) %</label>
                        <input type="number" id="gen-p3p" step="0.1" placeholder="Ex: 12.5">
                    </div>
                </div>
                <div class="form-group">
                    <label>Produtividade Acumulada (PAC)</label>
                    <input type="number" id="gen-pac" step="0.1" placeholder="Ex: 8.2">
                </div>

                <!-- DEPs: Carca√ßa -->
                <div class="section-title" style="margin-top:16px;">ü•© Carca√ßa e Musculatura</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>√Årea Olho Lombo (AOL)</label>
                        <input type="number" id="gen-aol" step="0.1" placeholder="Ex: 4.5">
                    </div>
                    <div class="form-group">
                        <label>Acabamento (EGS) mm</label>
                        <input type="number" id="gen-egs" step="0.1" placeholder="Ex: 0.8">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Musculatura Desmame</label>
                        <input type="number" id="gen-md" step="0.1" placeholder="Ex: 0.5">
                    </div>
                    <div class="form-group">
                        <label>Musculatura Sobreano</label>
                        <input type="number" id="gen-ms" step="0.1" placeholder="Ex: 0.6">
                    </div>
                </div>
                <div class="form-group">
                    <label>Precocidade (PS)</label>
                    <input type="number" id="gen-ps" step="0.1" placeholder="Ex: 0.4">
                </div>

                <!-- Bot√µes -->
                <div style="display:flex;gap:8px;margin-top:16px;">
                    <button type="button" class="submit-btn"
                        style="flex:1;background:linear-gradient(135deg,#7C3AED,#6D28D9);"
                        onclick="window.genetica.analisar()">üß¨ Analisar Touro</button>
                </div>
                <div style="display:flex;gap:8px;margin-top:8px;">
                    <button type="button"
                        style="flex:1;padding:12px;border:1px solid #374151;background:transparent;color:#D1D5DB;border-radius:10px;cursor:pointer;font-size:13px;"
                        onclick="window.genetica.preencherExemplo()">üìã Preencher Exemplo</button>
                    <button type="button"
                        style="flex:1;padding:12px;border:1px solid #374151;background:transparent;color:#D1D5DB;border-radius:10px;cursor:pointer;font-size:13px;"
                        onclick="window.genetica.limpar()">üóëÔ∏è Limpar</button>
                </div>
            </div>

            <!-- Resultado -->
            <div id="gen-resultado" style="display:none;margin-top:16px;"></div>

            <!-- Hist√≥rico -->
            <div id="gen-historico" style="margin-top:20px;"></div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- ACASALAMENTO DIRIGIDO ‚Äî UI de Sele√ß√£o e An√°lise -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div style="margin-top:28px;border-top:2px solid #374151;padding-top:20px;">
                <div class="section-title" style="font-size:18px;">üß¨ Acasalamento Dirigido</div>
                <div class="info-card"
                    style="background:linear-gradient(135deg,rgba(124,58,237,0.15),rgba(16,185,129,0.1));border:1px solid #7C3AED33;margin-bottom:16px;">
                    <p style="color:#D1D5DB;font-size:13px;margin:0;line-height:1.5;">
                        Selecione uma <strong>vaca</strong> do plantel e um <strong>touro</strong> do cat√°logo.
                        O sistema analisa compensa√ß√£o gen√©tica, consanguinidade e projeta o resultado pro FrigoGest.
                    </p>
                </div>

                <!-- Sele√ß√£o da Vaca -->
                <div class="section-title">üêÑ Selecione a Vaca</div>
                <div class="form-group">
                    <select id="acasal-vaca"
                        style="width:100%;padding:12px;background:#1F2937;color:#F3F4F6;border:1px solid #374151;border-radius:10px;font-size:14px;">
                        <option value="">-- Selecione uma matriz --</option>
                    </select>
                </div>
                <div id="acasal-vaca-info" style="display:none;margin-top:8px;"></div>

                <!-- Filtro de Ra√ßa do Touro -->
                <div class="section-title" style="margin-top:16px;">üêÇ Escolha o Touro</div>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px;">
                    <button class="acasal-raca-btn acasal-raca-active" onclick="window.genetica.filtrarTouros('todas')"
                        style="padding:8px 14px;border-radius:20px;border:1px solid #7C3AED;background:#7C3AED33;color:#C4B5FD;font-size:12px;cursor:pointer;">Todas</button>
                    <button class="acasal-raca-btn" onclick="window.genetica.filtrarTouros('Nelore')"
                        style="padding:8px 14px;border-radius:20px;border:1px solid #374151;background:transparent;color:#9CA3AF;font-size:12px;cursor:pointer;">Nelore</button>
                    <button class="acasal-raca-btn" onclick="window.genetica.filtrarTouros('Angus')"
                        style="padding:8px 14px;border-radius:20px;border:1px solid #374151;background:transparent;color:#9CA3AF;font-size:12px;cursor:pointer;">Angus</button>
                    <button class="acasal-raca-btn" onclick="window.genetica.filtrarTouros('Brahman')"
                        style="padding:8px 14px;border-radius:20px;border:1px solid #374151;background:transparent;color:#9CA3AF;font-size:12px;cursor:pointer;">Brahman</button>
                    <button class="acasal-raca-btn" onclick="window.genetica.filtrarTouros('Guzer√°')"
                        style="padding:8px 14px;border-radius:20px;border:1px solid #374151;background:transparent;color:#9CA3AF;font-size:12px;cursor:pointer;">Guzer√°</button>
                    <button class="acasal-raca-btn" onclick="window.genetica.filtrarTouros('Tabapu√£')"
                        style="padding:8px 14px;border-radius:20px;border:1px solid #374151;background:transparent;color:#9CA3AF;font-size:12px;cursor:pointer;">Tabapu√£</button>
                    <button class="acasal-raca-btn" onclick="window.genetica.filtrarTouros('Sindi')"
                        style="padding:8px 14px;border-radius:20px;border:1px solid #374151;background:transparent;color:#9CA3AF;font-size:12px;cursor:pointer;">Sindi</button>
                </div>

                <!-- Busca por nome -->
                <div class="form-group" style="margin-bottom:12px;">
                    <input type="text" id="acasal-busca" placeholder="üîç Buscar touro por nome..."
                        oninput="window.genetica.buscarTouroUI(this.value)"
                        style="width:100%;padding:12px;background:#1F2937;color:#F3F4F6;border:1px solid #374151;border-radius:10px;font-size:14px;">
                </div>

                <!-- Lista de Touros (cards) -->
                <div id="acasal-touros-lista"
                    style="display:flex;flex-direction:column;gap:10px;max-height:400px;overflow-y:auto;"></div>

                <!-- Bot√£o Analisar -->
                <div style="margin-top:16px;">
                    <button type="button" class="submit-btn"
                        style="width:100%;background:linear-gradient(135deg,#7C3AED,#10B981);font-size:16px;padding:16px;"
                        onclick="window.genetica.executarAcasalamento()">
                        üß¨ Analisar Acasalamento
                    </button>
                </div>

                <!-- Resultado do Acasalamento -->
                <div id="acasal-resultado" style="display:none;margin-top:16px;"></div>

                <!-- Sugest√£o autom√°tica -->
                <div style="margin-top:12px;">
                    <button type="button"
                        style="width:100%;padding:14px;border:1px solid #10B981;background:transparent;color:#10B981;border-radius:10px;cursor:pointer;font-size:14px;"
                        onclick="window.genetica.sugerirTouros()">
                        üí° Sugerir Melhores Touros pra essa Vaca
                    </button>
                </div>
                <div id="acasal-sugestoes" style="display:none;margin-top:12px;"></div>
            </div>

        </section>

        <!-- ===================== HUB: FINANCEIRO ===================== -->
        <section id="view-financeiro-hub" class="view hidden">
            <div class="view-header">
                <h2>Financeiro</h2>
            </div>
            <div class="home-grid">
                <button class="home-card" onclick="window.app.navigate('compra')">
                    <div class="home-card-icon" data-icon="compra"
                        style="background: linear-gradient(135deg, #0F766E, #115E59);"></div>
                    <span class="home-card-title">Compra</span>
                    <span class="home-card-sub">Compra de gado</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('venda')">
                    <div class="home-card-icon" data-icon="venda"
                        style="background: linear-gradient(135deg, #14532D, #166534);"></div>
                    <span class="home-card-title">Venda</span>
                    <span class="home-card-sub">Venda de gado</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('fluxo')">
                    <div class="home-card-icon" data-icon="fluxo"
                        style="background: linear-gradient(135deg, #1E3A5F, #1E40AF);"></div>
                    <span class="home-card-title">Fluxo</span>
                    <span class="home-card-sub">Caixa</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('balanco')">
                    <div class="home-card-icon" data-icon="balanco"
                        style="background: linear-gradient(135deg, #155E75, #164E63);"></div>
                    <span class="home-card-title">Balan√ßo</span>
                    <span class="home-card-sub">DRE</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('contas')">
                    <div class="home-card-icon" data-icon="contas"
                        style="background: linear-gradient(135deg, #78350F, #92400E);"></div>
                    <span class="home-card-title">Contas</span>
                    <span class="home-card-sub">A pagar</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('financeiro')">
                    <div class="home-card-icon" data-icon="indicadores"
                        style="background: linear-gradient(135deg, #44403C, #57534E);"></div>
                    <span class="home-card-title">Indicadores</span>
                    <span class="home-card-sub">Financeiros</span>
                </button>
            </div>
        </section>

        <!-- ===================== HUB: OPERA√á√ïES ===================== -->
        <section id="view-operacoes-hub" class="view hidden">
            <div class="view-header">
                <h2>Opera√ß√µes</h2>
            </div>
            <div class="home-grid">
                <button class="home-card" onclick="window.app.navigate('rastreabilidade')">
                    <div class="home-card-icon" data-icon="sisbov"
                        style="background: linear-gradient(135deg, #1E40AF, #3B82F6);"></div>
                    <span class="home-card-title">Rastreabilidade</span>
                    <span class="home-card-sub">SISBOV / GTA</span>
                </button>
                <button class="home-card" onclick="window.balanca.abrirModoPesagem()">
                    <div class="home-card-icon" data-icon="balanca_rfid"
                        style="background: linear-gradient(135deg, #059669, #10B981);"></div>
                    <span class="home-card-title">Modo Pesagem</span>
                    <span class="home-card-sub">Balan√ßa + RFID</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('estoque')">
                    <div class="home-card-icon" data-icon="estoque"
                        style="background: linear-gradient(135deg, #78350F, #92400E);"></div>
                    <span class="home-card-title">Estoque</span>
                    <span class="home-card-sub">Insumos e ra√ß√£o</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('obras')">
                    <div class="home-card-icon" data-icon="obras"
                        style="background: linear-gradient(135deg, #44403C, #57534E);"></div>
                    <span class="home-card-title">Obras</span>
                    <span class="home-card-sub">Constru√ß√µes</span>
                </button>
                <button class="home-card" onclick="window.app.navigate('funcionarios')">
                    <div class="home-card-icon" data-icon="funcionarios"
                        style="background: linear-gradient(135deg, #0F766E, #115E59);"></div>
                    <span class="home-card-title">Funcion√°rios</span>
                    <span class="home-card-sub">Equipe</span>
                </button>
            </div>
        </section>

        <!-- ===================== CABE√áAS INDIVIDUAIS ===================== -->
        <section id="view-cabecas" class="view hidden">
            <div class="view-header">
                <button class="back-btn" onclick="window.app.navigate('rebanho-hub')">‚Üê</button>
                <h2>Cabe√ßas Individuais</h2>
            </div>

            <!-- Search + Filters -->
            <div class="search-bar" style="margin-bottom:12px;">
                <input type="text" id="cab-search" placeholder="Buscar por brinco, nome ou ra√ßa..."
                    oninput="window.cabecas.setFilter('text', this.value)">
            </div>
            <div class="filter-bar" style="display:flex; gap:8px; margin-bottom:12px; flex-wrap:wrap;">
                <button type="button" class="filter-btn active"
                    onclick="window.cabecas.setFilter('sexo','todos'); this.parentNode.querySelectorAll('.filter-btn').forEach(function(b){b.classList.remove('active')}); this.classList.add('active')">Todos</button>
                <button type="button" class="filter-btn"
                    onclick="window.cabecas.setFilter('sexo','macho'); this.parentNode.querySelectorAll('.filter-btn').forEach(function(b){b.classList.remove('active')}); this.classList.add('active')">Machos</button>
                <button type="button" class="filter-btn"
                    onclick="window.cabecas.setFilter('sexo','femea'); this.parentNode.querySelectorAll('.filter-btn').forEach(function(b){b.classList.remove('active')}); this.classList.add('active')">F√™meas</button>
                <select id="cab-filter-lote" class="filter-select"
                    onchange="window.cabecas.setFilter('lote', this.value)">
                    <option value="todos">Todos os Lotes</option>
                </select>
            </div>

            <!-- Stats -->
            <div id="cabecas-stats" class="stats-panel"></div>

            <!-- Registration Form -->
            <form id="form-cabeca" class="card-form">
                <div class="section-title">Cadastrar Animal</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>N¬∫ Brinco *</label>
                        <input type="text" id="cab-brinco" placeholder="Ex: 0123" required>
                    </div>
                    <div class="form-group">
                        <label>Nome / Apelido</label>
                        <input type="text" id="cab-nome" placeholder="Opcional">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Sexo</label>
                        <select id="cab-sexo">
                            <option value="macho">Macho</option>
                            <option value="femea">F√™mea</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ra√ßa</label>
                        <input type="text" id="cab-raca" placeholder="Ex: Nelore">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Peso (kg)</label>
                        <input type="number" id="cab-peso" step="0.1" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>Data de Nascimento</label>
                        <input type="date" id="cab-nascimento">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Lote</label>
                        <select id="cab-lote">
                            <option value="">Sem lote</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Pasto</label>
                        <select id="cab-pasto">
                            <option value="">Sem pasto</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Observa√ß√µes</label>
                    <input type="text" id="cab-obs" placeholder="Opcional">
                </div>
                <div class="form-group">
                    <label>üì∏ Foto do Animal</label>
                    <div style="display:flex; gap:8px; align-items:center;">
                        <input type="file" id="cab-foto" accept="image/*" capture="environment"
                            style="font-size:12px; flex:1;">
                        <img id="cab-foto-preview"
                            style="width:48px;height:48px;border-radius:8px;object-fit:cover;display:none;border:2px solid var(--green);">
                    </div>
                </div>
                <button type="submit" class="submit-btn">Cadastrar Animal</button>
            </form>

            <!-- Animal List -->
            <div class="section-title" style="margin-top:24px;">Animais Cadastrados</div>
            <div id="cabecas-list"></div>
        </section>

    </main>

    <!-- ===================== MODAL: TROCAR PASTO ===================== -->
    <div id="modal-trocar-pasto" class="agro-modal">
        <div class="agro-modal-content">
            <div class="agro-modal-header">
                <h3>Trocar Pasto</h3>
                <button class="modal-close" onclick="window.lotes.fecharModal('modal-trocar-pasto')">‚úï</button>
            </div>
            <div class="agro-modal-body">
                <p><strong>Lote:</strong> <span id="modal-tp-lote"></span></p>
                <p><strong>Pasto Atual:</strong> <span id="modal-tp-atual"></span></p>
                <div class="form-group">
                    <label>Novo Pasto</label>
                    <select id="modal-tp-novo-pasto">
                        <option value="">Selecionar...</option>
                    </select>
                </div>
            </div>
            <div class="agro-modal-footer">
                <button class="submit-btn" onclick="window.lotes.confirmarTrocaPasto()">‚úÖ Confirmar Troca</button>
            </div>
        </div>
    </div>

    <!-- ===================== MODAL: JUNTAR LOTES ===================== -->
    <div id="modal-juntar-lotes" class="agro-modal">
        <div class="agro-modal-content">
            <div class="agro-modal-header">
                <h3>Juntar Lotes</h3>
                <button class="modal-close" onclick="window.lotes.fecharModal('modal-juntar-lotes')">‚úï</button>
            </div>
            <div class="agro-modal-body">
                <p style="font-size:13px; color:#666; margin-bottom:12px;">Selecione 2 ou mais lotes para unir. Os
                    animais ser√£o somados e o peso ser√° a m√©dia ponderada.</p>
                <div id="modal-jl-lista" class="checkbox-list"></div>
                <div class="form-group" style="margin-top:12px;">
                    <label>Nome do Novo Lote</label>
                    <input type="text" id="modal-jl-novo-nome" placeholder="Ex: Lote Unificado 2026">
                </div>
            </div>
            <div class="agro-modal-footer">
                <button class="submit-btn" onclick="window.lotes.confirmarJuntarLotes()">‚úÖ Juntar Lotes</button>
            </div>
        </div>
    </div>

    <!-- ===================== MODAL: ABASTECER COCHO ===================== -->
    <div id="modal-abastecer" class="agro-modal">
        <div class="agro-modal-content">
            <div class="agro-modal-header">
                <h3>Abastecer Cocho</h3>
                <button class="modal-close" onclick="window.lotes.fecharModal('modal-abastecer')">‚úï</button>
            </div>
            <div class="agro-modal-body">
                <p><strong>Lote:</strong> <span id="modal-ab-lote"></span></p>
                <p><strong>Produto:</strong> <span id="modal-ab-tipo"></span></p>
                <input type="hidden" id="modal-ab-produto" value="">
                <p id="modal-ab-consumo-info" style="font-size:12px; color:#666; margin-bottom:10px;"></p>
                <div class="form-row">
                    <div class="form-group">
                        <label>Quantidade de Sacos</label>
                        <input type="number" id="modal-ab-sacos" placeholder="4"
                            oninput="window.lotes.calcPrevisaoAbastecimento()">
                    </div>
                    <div class="form-group">
                        <label>Kg por Saco</label>
                        <input type="number" id="modal-ab-kg-saco" value="25" step="0.5"
                            oninput="window.lotes.calcPrevisaoAbastecimento()">
                    </div>
                </div>
                <div id="modal-ab-previsao" class="previsao-box"></div>
            </div>
            <div class="agro-modal-footer">
                <button class="submit-btn" onclick="window.lotes.confirmarAbastecimento()">‚úÖ Registrar
                    Abastecimento</button>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation Bar ‚Äî 5 Abas Organizadas -->
    <nav class="bottom-nav">
        <button class="nav-item active" onclick="window.app.navigate('home')" id="nav-home">
            <span class="nav-icon" data-icon="home"></span>
            Home
        </button>
        <button class="nav-item" onclick="window.app.navigate('rebanho-hub')" id="nav-rebanho">
            <span class="nav-icon" data-icon="rebanho"></span>
            Rebanho
        </button>
        <button class="nav-item" onclick="window.app.navigate('financeiro-hub')" id="nav-financeiro">
            <span class="nav-icon" data-icon="financeiro"></span>
            Financeiro
        </button>
        <button class="nav-item" onclick="window.app.navigate('operacoes-hub')" id="nav-operacoes">
            <span class="nav-icon" data-icon="operacoes"></span>
            Opera√ß√µes
        </button>
        <button class="nav-item" onclick="window.app.navigate('config')" id="nav-config">
            <span class="nav-icon" data-icon="config"></span>
            Config
        </button>
    </nav>

    <!-- Scripts -->
    <script src="js/icons.js?v=20260212a"></script>
    <script src="js/data.js?v=20260211r"></script>
    <script src="js/rebanho.js?v=20260211r"></script>
    <script src="js/pastos.js?v=20260211r"></script>
    <script src="js/lotes.js?v=20260211r"></script>
    <script src="js/obras.js?v=20260211r"></script>
    <script src="js/manejo.js?v=20260211r"></script>
    <script src="js/financeiro.js?v=20260211r"></script>
    <script src="js/estoque.js?v=20260211r"></script>
    <script src="js/funcionarios.js?v=20260211r"></script>
    <script src="js/rebanho-ops.js?v=20260211s"></script>
    <script src="js/clima.js"></script>
    <script src="js/pasto-mgmt.js?v=20260211s"></script>
    <script src="js/calendario.js?v=20260212b"></script>
    <script src="js/graficos.js?v=20260212a"></script>
    <script src="js/relatorio.js?v=20260212a"></script>
    <script src="js/contas.js?v=20260211s"></script>
    <script src="js/indicadores.js?v=20260211s"></script>
    <script src="js/nutricao.js"></script>
    <script src="js/balanca.js"></script>
    <script src="js/blockchain.js"></script>
    <script src="js/cabecas.js?v=20260212a"></script>
    <script src="js/rastreabilidade.js"></script>
    <script src="js/touros-catalogo.js?v=20260213a"></script>
    <script src="js/genetica.js?v=20260213b"></script>
    <script src="js/mascote.js?v=20260213a"></script>

    <script src="app.js"></script>

    <!-- Theme & Greeting Init -->
    <script>
        (function () {
            var h = new Date().getHours();

            // Light mode only ‚Äî no dark mode

            // Greeting
            var greetEl = document.getElementById('greeting-text');
            var dateEl = document.getElementById('greeting-date');
            if (greetEl) {
                if (h < 6) greetEl.textContent = 'Boa madrugada';
                else if (h < 12) greetEl.textContent = 'Bom dia';
                else if (h < 18) greetEl.textContent = 'Boa tarde';
                else greetEl.textContent = 'Boa noite';
            }
            if (dateEl) {
                var days = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'];
                var months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
                var now = new Date();
                dateEl.textContent = days[now.getDay()] + ', ' + now.getDate() + ' de ' + months[now.getMonth()] + ' de ' + now.getFullYear();
            }

            // Inject SVG icons into all data-icon elements
            if (window.ICONS) {
                document.querySelectorAll('[data-icon]').forEach(function (el) {
                    var key = el.getAttribute('data-icon');
                    if (window.ICONS[key]) el.innerHTML = window.ICONS[key];
                });
            }
        })();
    </script>

    <script>
        // Register Service Worker for PWA offline
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').then(function (reg) {
                console.log('[PWA] Service Worker registered:', reg.scope);
            }).catch(function (err) {
                console.log('[PWA] SW registration failed:', err);
            });
        }
    </script>
</body>

</html>